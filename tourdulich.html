<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPTRAVEL TOUR DU LỊCH</title>
    <!-- Chèn font -->
    <link rel="stylesheet" href="asset/css/font.css">
    <link rel="stylesheet" href="asset/css/color.css">
    <link rel="stylesheet" href="asset/css/text_style.css">
    <link rel="stylesheet" href="asset/css/background.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css">
    <script src="asset/javascrip/header.js"></script>
    <script src="asset/javascrip/formatnumber.js"></script>

    <!-- Thư viện w3.js -->
    <script src="https://www.w3schools.com/lib/w3.js"></script>

    <!-- Link css -->
    <link rel="stylesheet" href="asset/css/tourdulich.css">
    <link rel="stylesheet" href="./asset/css/tour-thi.css">

    <script language="javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script>
        function goThongTin(matour) {
            window.location.href = "detail.html?matour=" + matour;
        }
    </script>

    <!--  backtop1 -->
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" />
    <link rel="stylesheet" href="asset/css/backtop.css">
</head>

<body>
    <div class="container">
        <!--load header -->
        <div w3-include-html="header.html"></div>
        <div class="heigh-top"></div>

        <div class="tourdulich-content" style="margin-top: 10px;">
            <!-- Bỏ nội dung vô đây -->

            <div class="home__tintuc-dulich--title">
                <p class="home--title--item"> DU LỊCH MIỀN BẮC </p>
            </div>

            <div class="locsanpham">
                <div class="locsanpham-select" id="locSanPham">
                    <!-- <h2>LỌC KẾT QUẢ</h2>
                    <div>
                        <select name="quocgia" id="quocgia" class=" select-item">
                            <option value="0">--Chọn quốc gia--</option>
                            <option value="1">Tour trong nước</option>
                            <option value="2">Tour ngoài nước</option>
                        </select>
                    </div>
                    <div>
                        <select name="khuvuc" id="khuvuc" class=" select-item">
                            <option value="0">--Chọn khu vực--</option>
                            <option value="1">Tour trong nước</option>
                            <option value="2">Tour ngoài nước</option>
                        </select>
                    </div>

                    <div>
                        <select name="loaihinhtour" id="loaihinhtour" class=" select-item">
                            <option value="trongnuoc">--Loại hình tour--</option>
                            <option value="trongnuoc">Tour trọn gói</option>
                            <option value="trongnuoc">Tour gia đình</option>
                        </select>
                    </div>
                    <div>
                        <select name="diemdi" id="diemdi" class=" select-item">
                            <option value="0">--Điểm đi--</option>
                            <option value="3">Hà Nội</option>
                            <option value="4">TP. Hồ Chí Minh</option>
                        </select>
                    </div>
                    <div>
                        <select name="diemden" id="diemden" class="select-item">
                            <option value="0">--Điểm đến--</option>
                            <option value="5">Pháp</option>
                            <option value="6">Thụy Sĩ</option>
                            <option value="7">Nhật Bản</option>
                            <option value="8">Trung Quốc</option>
                            <option value="9">Canada</option>
                            <option value="10">Mỹ</option>
                        </select>
                    </div>
                    <div>
                        <select name="songaytour" id="songaytour" class="select-item">
                            <option value="0">--Số ngày tour--</option>
                            <option value="4-7">4-7 ngày</option>
                            <option value="8-14">8-14 ngày</option>
                            <option value=">14">Trên 14 ngày</option>
                        </select>
                    </div> -->
                </div>
                <div class="locsanpham-right">
                    <div class="sapxep-select">
                        <select name="Sắp xếp" id="sapxep-select">
                            <option value="sapxep">--Sắp xếp theo--</option>
                            <option value="thap-cao">Theo giá thấp đến cao</option>
                            <option value="cao-thap">Theo giá cao đến thấp</option>
                            <option value="theogiamgia">Giảm giá nhiều nhất</option>
                        </select>
                    </div>
                    <div id="category">

                        <!-- <div class="tour-item">
                            <div class="tour-item__image">
                                <a href="" title="Hà Nội - Bái Đính - Tràng An - Hạ Long - Yên Tử">
                                    <img src="asset/images/IMAGE/SanPham/TrongNuoc/MienBac/HaNoi/HN1.jpg"
                                        alt="Hà Nội - Bái Đính - Tràng An - Hạ Long - Yên Tử">
                                </a>
                            </div>
                            <div class="card-body">
                                <h3 class="tour-item__title">
                                    <a href="" title="Hà Nội - Bái Đính - Tràng An - Hạ Long - Yên Tử ">Hà Nội - Bái
                                        Đính -
                                        Tràng An - Hạ Long - Yên Tử </a>
                                </h3>
                                <p class="tour-item__code">
                                    Mã tour: abc1234
                                </p>
                                <p class="tour-item__departure">Nơi khởi hành: <span>TP. Hồ Chí Minh</span></p>
                                <div class="tour-item__price--current__number">
                                    Giá <span id="tour-item__price--current__number">8,390,000₫</span>/Khách
                                </div>
                                <div class="tour-item__price--current">
                                    <div class="btn btn-book">
                                        <a href="/Booking/TourBooking?tourId=801000d1-2dff-40ab-b45d-101e7bb3a2e6"
                                            class="btn-primary">
                                            <span id="icon"><img src="./asset/images/ICON/cart.png" alt=""></span>
                                            <label>
                                                Đặt ngay
                                            </label>
                                        </a>
                                    </div>
                                    <div class="btn btn-block">
                                        <a href="/tourNDSGN106-085-041221VN-V/ha-noi-bai-dinh-trang-an-ha-long-yen-tu-.aspx"
                                            title="Hà Nội - Bái Đính - Tràng An - Hạ Long - Yên Tử "
                                            class="btn product-item__summary__btn-login">
                                            <label>
                                                Xem chi tiết
                                            </label>
                                        </a>
                                    </div>
                                </div>
                                <div class="yeuthich"><a href=""><span id="icon"><img src="./asset/images/ICON/plus.png"
                                                alt=""></span> Thêm vào
                                        yêu thích</a></div>
                            </div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
        <!-- load footer -->
        <div w3-include-html="footer.html"></div>

        <!-- gọi thư viện -->

        <script>


            var xmlhttp = new XMLHttpRequest();
            var url = "asset/data/tour.json";
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var myArr = JSON.parse(this.responseText);
                    myFunction(myArr);
                    myFunction_loc(myArr);
                }
            }
            xmlhttp.open("GET", url, true);
            xmlhttp.send();

            function goThongtin(id){
                window.location.href = 'thongtin.html?matour=' + id;
            }
            function myFunction(arr) {
                var div = "<div class='locsanpham-tour'>";
                var i;
                for (i = 0; i < arr.length; i++) {
                    div += "<div class='tour-item'><div class='tour-item__image'><img src='" +
                        arr[i].images[1] + "'alt='" +
                        arr[i].ten_tour + "'></div><div class='card-body'><div  class='tour-item__title'><h3>" +
                        arr[i].ten_tour + "</h3></div><p class='tour-item__code'> Mã Tour: <span>" +
                        arr[i].ma_tour + "</span></p><p class='tour-item__departure'>Nơi khởi hành: <span>" +
                        arr[i].noikhoihanh + "</span></p><div class='tour-item__price--current__number'>Giá <span id='tour-item__price--current__number'>" +
                        formatNumber(arr[i].giatiennguoilon) + "đ</span>/Khách</div><div class='tour-item__price--current'><button  class='btn btn-book' onclick=" + 'goThongtin(' + "'"+  arr[i].ma_tour + "'" + ')' + "><span id='icon'><img src='./asset/images/ICON/cart.png' alt='Đặt hàng'></span> Đặt ngay</button><button class='btn btn-block' onclick='window.location.href='chitiettour.html?matour='" +
                        arr[i].ma_tour + "'>Xem chi tiết</button></div><button style='z-index: 10;' onclick='themvaoyeuthich(this)' class='yeuthich'><span id='icon'><img src='./asset/images/ICON/plus.png'alt='plus'></span> Thêm vào yêu thích</button></div></div>"
                    // div += "<div class='tour-item'><a href='chitiettour.html?matour=" +
                    //     arr[i].ma_tour + "' title='" +
                    //     arr[i].ten_tour + "'><div class='tour-item__image'><img src='" +
                    //     arr[i].images[1] + "'alt='" +
                    //     arr[i].ten_tour + "'></div><div class='card-body'><div  class='tour-item__title'><h3>" +
                    //     arr[i].ten_tour + "</h3></div><p class='tour-item__code'> Mã Tour: <span>" +
                    //     arr[i].ma_tour + "</span></p><p class='tour-item__departure'>Nơi khởi hành: <span>" +
                    //     arr[i].noikhoihanh + "</span></p><div class='tour-item__price--current__number'>Giá <span id='tour-item__price--current__number'>" +
                    //     formatNumber(arr[i].giatiennguoilon) + "đ</span>/Khách</div><div class='tour-item__price--current'><button  class='btn btn-book' onclick='window.location.href='chitiettour.html?matour='" +
                    //     arr[i].ma_tour + "'><span id='icon'><img src='./asset/images/ICON/cart.png' alt='Đặt hàng'></span> Đặt ngay</button><button class='btn btn-block' onclick='window.location.href='chitiettour.html?matour='" +
                    //     arr[i].ma_tour + "'>Xem chi tiết</button></div><button style='z-index: 10;' onclick='themvaoyeuthich(this)' class='yeuthich'><span id='icon'><img src='./asset/images/ICON/plus.png'alt='plus'></span> Thêm vào yêu thích</button></div></a></div>"

                    // onclick='goThongTin("+arr[i].ma_tour+")'
                }
                div += "</div>";
                document.getElementById("category").innerHTML = div;
            }

            // Lọc 
            function myFunction_loc(arr) {

                // arrKhuVuc = [a,b];
                // arrDiemDen = [];
                // arrSoNgayTour = [];
                var arrKhuVuc_tn = new Array();
                var arrKhuVuc_nn = new Array();


                var arrDiemDen_tn = new Array();
                var arrDiemDen_nn = new Array();


                var arrSoNgayTour = new Array();



                // add từ data thành arr
                // for (i = 0; i < arr.length; i++) {
                //     arrKhuVuc.push(arr[i].khuvuc);
                //     arrDiemDen.push(arr[i].diemden);
                //     arrSoNgayTour.push(arr[i].thoigian);
                // }
                for (i = 0; i < arr.length; i++) {
                    if (arr[i].quocgia == 'Tour du lịch trong nước') {
                        arrKhuVuc_tn.push(arr[i].khuvuc);
                        arrDiemDen_tn.push(arr[i].diemden);
                    }
                    if (arr[i].quocgia == 'Tour du lịch nước ngoài') {
                        arrKhuVuc_nn.push(arr[i].khuvuc);
                        arrDiemDen_nn.push(arr[i].diemden);
                    }


                    arrSoNgayTour.push(arr[i].thoigian);
                }
                arrKhuVuc_tn = arrKhuVuc_tn.filter((item, index) => arrKhuVuc_tn.indexOf(item) === index);
                arrKhuVuc_nn = arrKhuVuc_nn.filter((item, index) => arrKhuVuc_nn.indexOf(item) === index);

                arrDiemDen_tn = arrDiemDen_tn.filter((item, index) => arrDiemDen_tn.indexOf(item) === index);
                arrDiemDen_nn = arrDiemDen_nn.filter((item, index) => arrDiemDen_nn.indexOf(item) === index);

                arrSoNgayTour = arrSoNgayTour.filter((item, index) => arrSoNgayTour.indexOf(item) === index);
                // arrDiemDen = [...new Set(arrDiemDen)];
                // arrSoNgayTour = [...new Set(arrSoNgayTour)];

                var div = '<h2>LỌC KẾT QUẢ</h2><div><select onchange="locQuocGia(); " name="quocgia" id="quocgia" class=" select-item"><option value="0" id="op_none">--Chọn quốc gia--</option><option id="op_trongnuoc" value="1">Tour trong nước</option><option value="2" id="op_ngoainuoc">Tour ngoài nước</option></select></div><div ><select onclick="locQuocGia()" name="khuvuc" id="khuvuc" class=" select-item"><option value="0">--Chọn khu vực--</option>';

                for (var i = 0; i < arrKhuVuc_tn.length; i++) {
                    div += '<option class="TrongNuoc-distinguish" value="' + arrKhuVuc_tn[i] + '">' + arrKhuVuc_tn[i] + '</option>';
                };
                for (var i = 0; i < arrKhuVuc_nn.length; i++) {
                    div += '<option class="NgoaiNuoc-distinguish" value="' + arrKhuVuc_nn[i] + '">' + arrKhuVuc_nn[i] + '</option>';
                }

                div += '</select></div><div><select name="diemdi"id="diemdi" class=" select-item"><option value="0">--Điểm đi--</option><option value="Hà Nội">Hà Nội</option><option value="TP. Hồ Chí Minh">TP. Hồ Chí Minh</option></select></div><div><select onclick="locQuocGia()" name="diemden" id="diemden" class="select-item"><option  value="0">--Điểm đến--</option>'

                for (var i = 0; i < arrDiemDen_tn.length; i++) {
                    div += '<option class="TrongNuoc-distinguish" value="' + arrDiemDen_tn[i] + '">' + arrDiemDen_tn[i] + '</option>';
                };
                for (var i = 0; i < arrDiemDen_nn.length; i++) {
                    div += '<option class="NgoaiNuoc-distinguish" value="' + arrDiemDen_nn[i] + '">' + arrDiemDen_nn[i] + '</option>';
                }

                div += '</select></div><div><select name="songaytour" id="songaytour" class="select-item"><option value="0">--Số ngày tour--</option>'

                for (var i = 0; i < arrSoNgayTour.length; i++) {
                    div += '<option value="' + arrSoNgayTour[i] + '">' + arrSoNgayTour[i] + '</option>';
                }

                div += '</select></div>'
                document.getElementById("locSanPham").innerHTML = div;

            }



            function locQuocGia() {
                var value = document.getElementById("quocgia").value;
                var tn = document.getElementsByClassName("TrongNuoc-distinguish");
                var nn = document.getElementsByClassName("NgoaiNuoc-distinguish");
                if (value === '0') {
                    // window.location.href = ('tourdulich.html');
                    for (i = 0; i < tn.length; i++) {
                        tn[i].style.display = 'block';
                    }
                    for (i = 0; i < nn.length; i++) {
                        nn[i].style.display = 'block';
                    }
                }
                else if (value === '1') {
                    // window.location.href = ('tourdulich.html?quocgia=Trong Nước');
                    for (i = 0; i < tn.length; i++) {
                        tn[i].style.display = 'block';
                    }
                    for (i = 0; i < nn.length; i++) {
                        nn[i].style.display = 'none';
                    }


                }
                else if (value === '2') {
                    // window.location.href = ('tourdulich.html?quocgia=NgoaiNuoc');

                    for (i = 0; i < tn.length; i++) {
                        tn[i].style.display = 'none';
                    }
                    for (i = 0; i < nn.length; i++) {
                        nn[i].style.display = 'block';
                    }
                }
            }

            //Xử lý khi load trang



            w3.includeHTML();




        </script>

        <!-- //Xử lý link -->
        <script>

            // Xử lú UTF8-Decode
            function utf8Decode(utf8String) {
                if (typeof utf8String != "string") throw new TypeError("Paarr not???");
                const unicodeString = utf8String.replace(/[u00e0-\u00ef][\u0080-\u00bf][\0080-\u00bf]/g,
                    function (c) {
                        var cc = ((c.charCodeAt(0) & 0x0f) << 12) | (c.charCodeAt(1) & 0x3f) << 6 | (c.charCodeAt(2) & 0x3f);
                        return String.fromCharCode(cc);
                    }).replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,
                        function (c) {
                            var cc = (c.charCodeAt(0) & 0x1f) << 6 | c.charCodeAt(1) & 0x3f;
                            return String.fromCharCode(cc);
                        });

                return unicodeString;
            }



            function getUrlParams() {
                var params = {};
                var queryString = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {
                    params[key] = value;
                });
                return params;
            }
            var quocgia = utf8Decode(unescape(getUrlParams().quocgia)).split('+').join(' ');
            var khuvuc = utf8Decode(unescape(getUrlParams().khuvuc)).split('+').join(' ');


            //Function để change sel - JQuery
            function changeSel_option(id_sel, value_option) {

                const $select = document.querySelector('#' + id_sel);
                $select.value = value_option;

                // window.onload = function () {
                //     const $select = document.querySelector('#' + id_sel);
                //     $select.value = value_option;
                // };
            }

            if (quocgia == 'Trong Nước') {
                window.onload = function () {
                    changeSel_option('quocgia', '1');
                }


                if (khuvuc == 'Miền Bắc') {
                    window.onload = function () {
                        changeSel_option('quocgia', '1');
                        changeSel_option('khuvuc', 'Miền Bắc');
                    }

                }
                if (khuvuc == 'Miền Trung') {
                    window.onload = function () {
                        changeSel_option('quocgia', '1');
                        changeSel_option('khuvuc', 'Miền Trung');
                    }

                }
                if (khuvuc == 'Miền Nam') {
                    window.onload = function () {
                        changeSel_option('quocgia', '1');
                        changeSel_option('khuvuc', 'Miền Nam');
                    }

                }
            }
            if (quocgia == 'NgoaiNuoc') {
                window.onload = function () {
                    changeSel_option('quocgia', '2');
                }

                if (khuvuc == 'ChauA') {
                    window.onload = function () {
                        changeSel_option('quocgia', '2');
                        changeSel_option('khuvuc', 'Châu Á');
                    }

                }
                if (khuvuc == 'ChauAu') {
                    window.onload = function () {
                        changeSel_option('quocgia', '2');
                        changeSel_option('khuvuc', 'Châu Âu');
                    }

                }
                if (khuvuc == 'ChauMy') {
                    window.onload = function () {
                        changeSel_option('quocgia', '2');
                        changeSel_option('khuvuc', 'Châu Mỹ');
                    }

                }
            }

            //Xử lý lọc

            w3.includeHTML();
        </script>
        <script src="asset/javascrip/tourdulich.js"></script>
        <script src="asset/javascrip/yeuthich.js"></script>


    </div>
    <!--  backtop2 -->
    <div id="backtop">
        <i class="fas fa-chevron-up"></i>
    </div>
</body>
<!-- backtop3 -->
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>
<script src="./asset/javascrip/backtop.js">
</script>

</html>